set ratios 1:2:3

# Basic vars
set shell bash
set previewer ~/.config/lf/preview
set shellopts '-eu'
set ifs "\n"
set scrolloff 10

# cmds/functions
cmd open ${{
    case $(file --mime-type $f -b) in
      text/*|application/json) $EDITOR $fx;;
    esac
}}

cmd rename %[ -e $1 ] && printf "file exists" || mv $f $1

cmd delete ${{
  set -f
  printf "%s\n\t" "$fx"
  printf "delete?[y/N] "
  read ans
  [ $ans = "y" ] && echo $fx | xargs -I'{}' rm -r '{}'
}}

cmd moveto ${{
  set -f
  clear; echo "Move to where?"
  dest="$(find $OLDPWD -type d -print 2>/dev/null | fzf)" &&
  eval mv -iv $fx $dest &&
  notify-send "File(s) moved." "File(s) moved to $dest."
}}

cmd copyto ${{
  set -f
  clear; echo "Copy to where?"
  dest="$(find $OLDPWD -type d -print 2>/dev/null | fzf)" &&
  eval cp -ivr $fx $dest &&
  notify-send "File(s) copied." "File(s) copies to $dest."
}}

# Bindings
# Find a file
map f ${{
  set -f
  path=$(fzf --walker-root $OLDPWD --walker-skip=.git,.devenv,.venv)
  lf -remote "send $id select $path"
}}
map g top
map d delete
map c copyto
map m moveto
map a ${{
  set -f
  echo "Content of directory $PWD"
  exa -a -s type
  read -p "New file or directory name? " path
  if [[ $path == */ ]]; then
    mkdir -p $path
  else
    mkdir -p $(dirname $path)
    touch $path
  fi
  lf -remote "send $id select $path"
}}
map r push :rename<space>
